


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > ProductService</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">code.with.vanilson.productservice</a>
</div>

<h1>Coverage Summary for Class: ProductService (code.with.vanilson.productservice)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">ProductService</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (12/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (14/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (44/44)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package code.with.vanilson.productservice;
&nbsp;
&nbsp;import code.with.vanilson.productservice.exception.ProductNotFoundException;
&nbsp;import code.with.vanilson.productservice.exception.ProductNullException;
&nbsp;import lombok.extern.slf4j.Slf4j;
&nbsp;import org.springframework.stereotype.Service;
&nbsp;
&nbsp;import java.text.MessageFormat;
&nbsp;import java.util.List;
&nbsp;import java.util.Optional;
&nbsp;
&nbsp;@Service
<b class="fc">&nbsp;@Slf4j</b>
&nbsp;public class ProductService {
&nbsp;
&nbsp;    public static final String PRODUCT_WITH_ID_0_WAS_NOT_FOUND = &quot;Product  with id {0} was not found&quot;;
&nbsp;    private final ProductRepository productRepository;
&nbsp;    private final ProductMapper productMapper;
&nbsp;
<b class="fc">&nbsp;    public ProductService(ProductRepository productRepository, ProductMapper productMapper) {</b>
<b class="fc">&nbsp;        this.productMapper = productMapper;</b>
<b class="fc">&nbsp;        this.productRepository = productRepository;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Retrieves all products and maps them to a list of ProductResponse objects.
&nbsp;     *
&nbsp;     * @return List of ProductResponse objects representing all products
&nbsp;     */
&nbsp;    public List&lt;ProductResponse&gt; getAllProducts() {
<b class="fc">&nbsp;        var products = productRepository.findAll();</b>
<b class="fc">&nbsp;        log.info(&quot;getAllProducts returned {}&quot;, products);</b>
<b class="fc">&nbsp;        return productMapper.toProductResponse(products);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Retrieves a product by its ID.
&nbsp;     *
&nbsp;     * @param id The ID of the product to retrieve.
&nbsp;     * @return An {@code Optional} containing the {@code ProductResponse} if found, or an empty {@code Optional} if not found.
&nbsp;     * @throws ProductNotFoundException If no product with the specified ID is found.
&nbsp;     */
&nbsp;    public Optional&lt;ProductResponse&gt; getProductById(int id) {
<b class="fc">&nbsp;        var products = productRepository.findById(id)</b>
<b class="fc">&nbsp;                .map(productMapper::fromProduct)</b>
<b class="fc">&nbsp;                .orElseThrow(() -&gt; new ProductNotFoundException(</b>
<b class="fc">&nbsp;                        MessageFormat.format(PRODUCT_WITH_ID_0_WAS_NOT_FOUND, id)));</b>
&nbsp;
<b class="fc">&nbsp;        return Optional.ofNullable(products);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Creates a new product in the system.
&nbsp;     *
&nbsp;     * @param product The product to be created.
&nbsp;     * @return The created product request.
&nbsp;     */
&nbsp;    public ProductRequest createProduct(Product product) {
<b class="fc">&nbsp;        if (product == null) {</b>
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product must not be null&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        var savedProduct = productRepository.save(product);</b>
<b class="fc">&nbsp;        log.info(&quot;createProduct with saved product {}&quot;, savedProduct);</b>
<b class="fc">&nbsp;        return productMapper.toProductRequest(savedProduct);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Creates new products in the system.
&nbsp;     *
&nbsp;     * @param products The list of products to be created.
&nbsp;     * @return The list of created product requests.
&nbsp;     */
&nbsp;    public List&lt;ProductRequest&gt; createProducts(List&lt;Product&gt; products) {
<b class="fc">&nbsp;        if (products == null || products.isEmpty()) {</b>
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product list must not be null or empty&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        List&lt;Product&gt; savedProducts = productRepository.saveAll(products);</b>
<b class="fc">&nbsp;        log.info(&quot;createProducts with saved products {}&quot;, savedProducts);</b>
<b class="fc">&nbsp;        return productMapper.toProductRequests(savedProducts);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Updates a product with the given ID using the provided product details.
&nbsp;     *
&nbsp;     * @param id      The ID of the product to update.
&nbsp;     * @param product The updated product details.
&nbsp;     * @return The updated product as a {@code ProductRequest}.
&nbsp;     * @throws ProductNotFoundException If no product with the specified ID is found.
&nbsp;     */
&nbsp;    public ProductRequest updateProduct(int id, Product product) {
<b class="fc">&nbsp;        Product existingProduct = productRepository.findById(id)</b>
<b class="fc">&nbsp;                .orElseThrow(() -&gt; new ProductNotFoundException(MessageFormat.format(PRODUCT_WITH_ID_0_WAS_NOT_FOUND</b>
<b class="fc">&nbsp;                        , id)));</b>
&nbsp;
&nbsp;        // Update existing product with new values
<b class="fc">&nbsp;        updateProductDetails(existingProduct, product);</b>
&nbsp;
&nbsp;        // Save and return the updated product
<b class="fc">&nbsp;        var savedProduct = productRepository.save(existingProduct);</b>
<b class="fc">&nbsp;        return productMapper.toProductRequest(savedProduct);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Deletes a product with the given ID.
&nbsp;     *
&nbsp;     * @param id The ID of the product to delete.
&nbsp;     * @throws ProductNotFoundException If no product with the specified ID is found.
&nbsp;     */
&nbsp;    public void deleteProduct(int id) {
<b class="fc">&nbsp;        var products = productRepository.findById(id)</b>
<b class="fc">&nbsp;                .orElseThrow(() -&gt; new ProductNotFoundException(</b>
<b class="fc">&nbsp;                        MessageFormat.format(PRODUCT_WITH_ID_0_WAS_NOT_FOUND, id)));</b>
&nbsp;
<b class="fc">&nbsp;        productRepository.deleteById(products.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Updates the details of an existing product with the provided updated product details.
&nbsp;     * Checks for null values in the updated product details and ensures that certain fields are not null or negative.
&nbsp;     *
&nbsp;     * @param existingProduct The existing product whose details are being updated.
&nbsp;     * @param updatedProduct  The updated product details to apply.
&nbsp;     * @throws ProductNullException If any of the updated product details are null or if the available quantity is negative.
&nbsp;     */
&nbsp;    private void updateProductDetails(Product existingProduct, Product updatedProduct) {
<b class="fc">&nbsp;        if (updatedProduct.getName() != null) {</b>
<b class="fc">&nbsp;            existingProduct.setName(updatedProduct.getName());</b>
&nbsp;        } else {
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product name must not be null&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (updatedProduct.getDescription() != null) {</b>
<b class="fc">&nbsp;            existingProduct.setDescription(updatedProduct.getDescription());</b>
&nbsp;        } else {
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product description must not be null&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (updatedProduct.getAvailableQuantity() &gt;= 0.0) {</b>
<b class="fc">&nbsp;            existingProduct.setAvailableQuantity(updatedProduct.getAvailableQuantity());</b>
&nbsp;        } else {
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product available quantity must be greater than 0&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (updatedProduct.getPrice() != null) {</b>
<b class="fc">&nbsp;            existingProduct.setPrice(updatedProduct.getPrice());</b>
&nbsp;        } else {
<b class="fc">&nbsp;            throw new ProductNullException(&quot;Product price must not be null&quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-06-03 17:43</div>
</div>
</body>
</html>
